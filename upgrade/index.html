<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Secret Mapçš„ãª</title>
<style>
/* CSSå¤‰æ•°ã§å…‰ã®ä½ç½®ã¨ã‚µã‚¤ã‚ºã‚’ç®¡ç† */
:root{
  --x: 50%;
  --y: 50%;
  --size: 80px;
  --soft: 40px;
  --dim: 0.95;
}

*{box-sizing:border-box}
html,body{
  height:100%;
  margin:0;
  font-family: 'Georgia', serif;
  overflow: hidden;
}

/* ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒŠ - å¤ã„åœ°å›³ã®ã‚ˆã†ãªèƒŒæ™¯ */
.map-container{
  min-height:100vh;
  position:relative;
  background: 
    linear-gradient(45deg, #2a1810 0%, #3d2817 50%, #2a1810 100%);
  color:#f4e4c1;
  overflow:hidden;
  outline: none;
}

/* åœ°å›³ã®ãƒ†ã‚¯ã‚¹ãƒãƒ£ï¼ˆç´™ã®ã‚ˆã†ãªè³ªæ„Ÿï¼‰ */
.map-container::after{
  content:"";
  position:absolute;
  inset:0;
  z-index:1;
  background: 
    repeating-linear-gradient(
      0deg,
      transparent,
      transparent 2px,
      rgba(0,0,0,0.03) 2px,
      rgba(0,0,0,0.03) 4px
    );
  mix-blend-mode: multiply;
  pointer-events:none;
}

/* ã‚¹ãƒãƒƒãƒˆãƒ©ã‚¤ãƒˆåŠ¹æœ - ãƒã‚¦ã‚¹ä½ç½®ã«è¿½å¾“ */
.map-container::before{
  content:"";
  position:absolute;
  inset:0;
  z-index:5;
  background:
    radial-gradient(
      circle at var(--x) var(--y),
      rgba(0,0,0,0) calc(var(--size) * 0.2),
      rgba(0,0,0,0.4) calc(var(--size) * 0.8),
      rgba(0,0,0,var(--dim)) calc(var(--size) + var(--soft))
    );
  pointer-events:none;
  transition: background 80ms ease-out;
}

/* åœ°å›³ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒªã‚¢ */
.map-content{
  position: relative;
  z-index: 2;
  padding: 60px 40px;
  max-width: 1200px;
  margin: 0 auto;
  min-height: 100vh;
}



/* ç§˜å¯†ã®å ´æ‰€ãƒãƒ¼ã‚«ãƒ¼ */
.secret-spot{
  position: absolute;
  width: 40px;
  height: 40px;
  background: radial-gradient(circle, #ff6b6b 0%, #c92a2a 100%);
  border-radius: 50%;
  border: 3px solid #d4af37;
  cursor: pointer;
  transition: transform 0.2s, box-shadow 0.2s;
  z-index: 3;
  box-shadow: 0 0 20px rgba(255,107,107,0.6);
}

.secret-spot:hover{
  transform: scale(1.2);
  box-shadow: 0 0 30px rgba(255,107,107,0.9);
}



/* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ */
@media (max-width:768px){
  :root{ --size:120px; --soft:60px; }
  .map-content{ padding: 40px 20px; }
  .controls{ font-size: 11px; padding: 10px 16px; }
  .secret-spot{ width: 35px; height: 35px; }
}
</style>
</head>
<body>

<div class="map-container" id="mapContainer" tabindex="0" role="application" aria-label="ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ç§˜å¯†ã®åœ°å›³">
  <div class="map-content">
    <!-- ç§˜å¯†ã®å ´æ‰€ãƒãƒ¼ã‚«ãƒ¼ï¼ˆã‚¯ãƒªãƒƒã‚¯ã§ç™ºè¦‹ï¼‰ -->
    <div class="secret-spot" style="top:15%;left:20%;" data-discovered="false"></div>
    <div class="secret-spot" style="top:40%;left:70%;" data-discovered="false"></div>
    <div class="secret-spot" style="top:65%;left:30%;" data-discovered="false"></div>
    <div class="secret-spot" style="top:25%;left:85%;" data-discovered="false"></div>
    <div class="secret-spot" style="top:80%;left:60%;" data-discovered="false"></div>
    <div class="secret-spot" style="top:50%;left:45%;" data-discovered="false"></div>
  </div>
</div>

<script>
/* ========================
   åˆæœŸè¨­å®š
   ======================== */
const mapContainer = document.getElementById('mapContainer');
const secretSpots = document.querySelectorAll('.secret-spot');
let discoveredCount = 0;

/* ========================
   ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
   ======================== */
// ãƒ‘ãƒ¼ã‚»ãƒ³ãƒˆæ–‡å­—åˆ—ã‚’æ•°å€¤ã«å¤‰æ›
function pctToNum(s){
  return parseFloat(s.trim().replace('%','')) || 0;
}

// æ•°å€¤ã‚’0-100ã«ã‚¯ãƒ©ãƒ³ãƒ—ã—ã¦ãƒ‘ãƒ¼ã‚»ãƒ³ãƒˆæ–‡å­—åˆ—ã«
function clampPct(n){
  return Math.min(100, Math.max(0, n)) + '%';
}

/* ========================
   ã‚¹ãƒãƒƒãƒˆãƒ©ã‚¤ãƒˆä½ç½®ã®æ›´æ–°
   ======================== */
function updateSpotlight(clientX, clientY){
  const rect = mapContainer.getBoundingClientRect();
  // ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆåº§æ¨™ã‚’è¦ç´ å†…ã®ç›¸å¯¾ä½ç½®ï¼ˆ%ï¼‰ã«å¤‰æ›
  let x = ((clientX - rect.left) / rect.width) * 100;
  let y = ((clientY - rect.top) / rect.height) * 100;
  // ç¯„å›²ã‚’0-100%ã«åˆ¶é™
  x = Math.min(100, Math.max(0, x));
  y = Math.min(100, Math.max(0, y));
  // CSSå¤‰æ•°ã‚’æ›´æ–°
  mapContainer.style.setProperty('--x', x + '%');
  mapContainer.style.setProperty('--y', y + '%');
}

/* ========================
   ãƒã‚¦ã‚¹/ãƒã‚¤ãƒ³ã‚¿/ã‚¿ãƒƒãƒå¯¾å¿œ
   ======================== */
// ãƒã‚¤ãƒ³ã‚¿ç§»å‹•ï¼ˆãƒã‚¦ã‚¹ãƒ»ãƒˆãƒ©ãƒƒã‚¯ãƒ‘ãƒƒãƒ‰ï¼‰
mapContainer.addEventListener('pointermove', (e) => {
  updateSpotlight(e.clientX, e.clientY);
}, {passive:true});

// ã‚¿ãƒƒãƒç§»å‹•ï¼ˆã‚¹ãƒãƒ›ãƒ»ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆï¼‰
mapContainer.addEventListener('touchmove', (e) => {
  const touch = e.touches[0];
  if(touch) updateSpotlight(touch.clientX, touch.clientY);
}, {passive:true});

// ãƒã‚¦ã‚¹ç§»å‹•ï¼ˆäº’æ›æ€§ã®ãŸã‚ï¼‰
window.addEventListener('mousemove', (e) => {
  updateSpotlight(e.clientX, e.clientY);
}, {passive:true});

/* ========================
   ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰æ“ä½œï¼ˆçŸ¢å°ã‚­ãƒ¼ãƒ»WASDï¼‰
   ======================== */
const moveStep = 3; // 1å›ã®ç§»å‹•é‡ï¼ˆ%ï¼‰

function moveSpotlight(dx, dy){
  const style = getComputedStyle(mapContainer);
  const currentX = pctToNum(style.getPropertyValue('--x'));
  const currentY = pctToNum(style.getPropertyValue('--y'));
  const newX = clampPct(currentX + dx);
  const newY = clampPct(currentY + dy);
  mapContainer.style.setProperty('--x', newX);
  mapContainer.style.setProperty('--y', newY);
}

window.addEventListener('keydown', (e) => {
  switch(e.key){
    case 'ArrowLeft': case 'a': case 'A':
      e.preventDefault();
      moveSpotlight(-moveStep, 0);
      break;
    case 'ArrowRight': case 'd': case 'D':
      e.preventDefault();
      moveSpotlight(moveStep, 0);
      break;
    case 'ArrowUp': case 'w': case 'W':
      e.preventDefault();
      moveSpotlight(0, -moveStep);
      break;
    case 'ArrowDown': case 's': case 'S':
      e.preventDefault();
      moveSpotlight(0, moveStep);
      break;
    case 'Home':
      // Homeã‚­ãƒ¼ã§ä¸­å¤®ã«ãƒªã‚»ãƒƒãƒˆ
      mapContainer.style.setProperty('--x','50%');
      mapContainer.style.setProperty('--y','50%');
      break;
  }
});

/* ========================
   ç§˜å¯†ã®å ´æ‰€ã®ç™ºè¦‹æ©Ÿèƒ½
   ======================== */
secretSpots.forEach(spot => {
  spot.addEventListener('click', function(){
    // ã¾ã ç™ºè¦‹ã•ã‚Œã¦ã„ãªã„å ´æ‰€ã®ã¿ã‚«ã‚¦ãƒ³ãƒˆ
    if(this.getAttribute('data-discovered') === 'false'){
      this.setAttribute('data-discovered', 'true');
      // ç™ºè¦‹æ¸ˆã¿ã®è¦–è¦šçš„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
      this.style.background = 'radial-gradient(circle, #51cf66 0%, #2f9e44 100%)';
      this.style.boxShadow = '0 0 30px rgba(81,207,102,0.9)';
      // ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã‚’æ›´æ–°
      discoveredCount++;
      // å…¨ã¦ç™ºè¦‹ã—ãŸã‚‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
      if(discoveredCount === 6){
        setTimeout(() => {
          alert('ğŸ‰ å…¨ã¦ã®å ´æ‰€ã‚’ç™ºè¦‹ã—ã¾ã—ãŸï¼');
        }, 300);
      }
    }
  });
});

/* ========================
   åˆæœŸåŒ–
   ======================== */
// ã‚¹ãƒãƒƒãƒˆãƒ©ã‚¤ãƒˆã‚’ä¸­å¤®ã«é…ç½®
mapContainer.style.setProperty('--x', '50%');
mapContainer.style.setProperty('--y', '50%');

// ã‚¯ãƒªãƒƒã‚¯ã§ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ï¼ˆã‚­ãƒ¼ãƒœãƒ¼ãƒ‰æ“ä½œã®ãŸã‚ï¼‰
mapContainer.addEventListener('click', () => mapContainer.focus());
</script>

</body>
</html>